plot_usmap(data = StateRate, values = "Rate", lines = "red") +
scale_fill_continuous(low = "green", high = "brown",
name = "Population (2010)", label = scales::comma)+
theme(legend.position = "right");
x=2017
data_year=dplyr::filter(StateRate, Year == x);
data_year
plot_usmap(data = data_year, values = "Rate", lines = "red") +
scale_fill_continuous(low = "green", high = "brown", name = "Rate", label = scales::comma)+
ggtitle(paste("Distribution of US Unemployment Rate in Year",x))+
theme(legend.position = "top");
library(gridExtra);
RateMaps=list();
for( i in 1:5)
{
RateMaps[[i]]=PlotRate(i+2012);
}
PlotRate= function(x)
{
data_year=dplyr::filter(StateRate, Year == x);
plot_usmap(data = data_year, values = "Rate", lines = "red") +
scale_fill_continuous(low = "green", high = "brown", name = "Rate", label = scales::comma)+
ggtitle(paste("Distribution of US Unemployment Rate in Year",x))+
theme(legend.position = "top");
}
PlotRate
library(gridExtra);
RateMaps=list();
for( i in 1:5)
{
RateMaps[[i]]=PlotRate(i+2012);
}
gridExtra::grid.arrange(grobs = RateMaps,nrow=5,ncol=1);
library(gridExtra);
RateMaps=list();
for( i in 1:5)
{
RateMaps[[i]]=PlotRate(i+2012);
}
gridExtra::grid.arrange(grobs = RateMaps,nrow=3,ncol=2);
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:5) print(PlotRate(i+2012));
dev.off();
StateAnimation = image_animate(img, fps = 1);
print(StateAnimation);
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
library(stringr);
CountyRate$County=as.character(CountyRate$County);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
library(stringr);  library(dplyr);
CountyRate$County=as.character(CountyRate$County);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
str(CountyRate)
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate(CountyPop, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
StateFips
head(CountyRate);
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate(CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year == x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette = "Pastel2", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate in Year",x))+
theme(legend.position = "right");
}
2017-1990
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
library(usmap);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year == x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette = "Pastel2", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year == x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette = "Pastel2", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyAnimation = image_animate(img, fps = 2);
print(CountyAnimation);
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
library(stringr);  library(dplyr);
CountyRate$County=as.character(CountyRate$County);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate( CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
x=2017
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_colour_gradientn(colours=terrain.colors(8), name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
library(usmap);  library(ggplot2);
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_colour_gradientn(colours=terrain.colors(8), name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_colour_brewer(palette = "Reds", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette = "Reds", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_continuous(type = "gradient", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", breaks=8, name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_continuous(low = "green", high = "red",  name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", breaks=c(2,4,6,8,10,12), name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", fill=fill_continuous, lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", quantile(fill_continuous), name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
bins=7; # consider 7 percentitles
CountyRate= dplyr::mutate(CountyRate,
rate = cut(Rate, quantile(Rate, seq(0, 1, len = bins)),
include.lowest = TRUE));
str(CountyRate)
bins=7; # consider 7 percentitles
CountyRate$Rate=as.numeric(CountyRate$Rate);
CountyRate= dplyr::mutate(CountyRate,
rate = cut(Rate, quantile(Rate, seq(0, 1, len = bins)),
include.lowest = TRUE));
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", breaks=c(2,4,6,8,10,12), name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Reds", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyRateAnimation = image_animate(img, fps = 2);
print(CountyRateAnimation);
image_write(CountyRateAnimation, "CountyRateAnimation.gif")
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Pastel2", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyRateAnimation = image_animate(img, fps = 2);
print(CountyRateAnimation);
str(CountyRate)
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
str(CountyRate);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
str(CountyRate);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
#CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
which(complete.cases(CountyRate))
which(complete.cases(CountyRate)==F)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
#CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
which(complete.cases(CountyRate)==F)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
#CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
which(complete.cases(CountyRate)==F)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",");
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
which(complete.cases(CountyRate)==F)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
#CountyRate$Rate=as.numeric(as.character(CountyRate$Rate));
which(complete.cases(CountyRate)==F)
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F)
str(CountyRate);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F);
CountyRate=filter(CountyRate, complete.cases(Rate) == T); #remove the missing values
library(dplyr);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F);
CountyRate=filter(CountyRate, complete.cases(Rate) == T); #remove the missing values
library(stringr);  library(dplyr);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
str(CountyRate)
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate( CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
bins=7; # consider 7 percentitles
CountyRate$Rate=as.numeric(CountyRate$Rate);
CountyRate= dplyr::mutate(CountyRate,
rate = cut(Rate, quantile(Rate, seq(0, 1, len = bins)),
include.lowest = TRUE));
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Set1", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyRateAnimation = image_animate(img, fps = 2);
print(CountyRateAnimation);
which(complete.cases(CountyRate)==F);
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(dplyr);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F);
CountyRate=filter(CountyRate, complete.cases(Rate) == T); #remove the missing values
which(complete.cases(CountyRate)==F);
library(stringr);  library(dplyr);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate( CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
bins=7; # consider 7 percentitles
CountyRate$Rate=as.numeric(CountyRate$Rate);
CountyRate= dplyr::mutate(CountyRate,
rate = cut(Rate, quantile(Rate, seq(0, 1, len = bins)),
include.lowest = TRUE));
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="Rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Set1", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
str(CountyRate)
CountyRate= dplyr::mutate(CountyRate,
rate = ifelse(Rate<=2.0, "2% or lower",
ifelse(Rate>2 & Rate<=4, "2% to 4%",
ifelse(Rate>4 & Rate<=6, "4% to 6%",
ifelse(Rate>6 & Rate<=8, "6% to 8%",
ifelse(Rate>8 & Rate<=10, "8% to 10%",
ifelse(Rate>10 & Rate<=12, "10% to 12%","12% or over"))))))
);
str(CountyRate)
CountyRate$rate=as.factor(CountyRate$rate);
str(CountyRate)
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Set1", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyRateAnimation = image_animate(img, fps = 2);
print(CountyRateAnimation);
which(complete.cases(CountyRate)==F);
CountyRate$rate=factor(CountyRate$rate, levels = c("2% or lower", "2% to 4%", "4% to 6%","6% to 8%", "8% to 10%","10% to 12%","12% or over")); #order the factor levels
str(CountyRate)
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(dplyr);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F);  #some counties have missing values
#CountyRate=filter(CountyRate, complete.cases(Rate) == T);
library(stringr);  library(dplyr);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate( CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
CountyRate= dplyr::mutate(CountyRate,
rate = ifelse(Rate<=2.0, "2% or lower",
ifelse(Rate>2 & Rate<=4, "2% to 4%",
ifelse(Rate>4 & Rate<=6, "4% to 6%",
ifelse(Rate>6 & Rate<=8, "6% to 8%",
ifelse(Rate>8 & Rate<=10, "8% to 10%",
ifelse(Rate>10 & Rate<=12, "10% to 12%","12% or over"))))))
);
CountyRate$rate=as.factor(CountyRate$rate);
CountyRate$rate=factor(CountyRate$rate, levels = c("12% or over","10% to 12%","8% to 10%","6% to 8%","4% to 6%","2% to 4%", "2% or lower")); #order the factor levels
which(complete.cases(CountyRate)==F);
unique(CountyRate$rate)
which(complete.cases(CountyRate)==F);
CountyRate= dplyr::mutate(CountyRate,
rate = ifelse(Rate<=2.0, "2% or lower",
ifelse(Rate>2 & Rate<=4, "2% to 4%",
ifelse(Rate>4 & Rate<=6, "4% to 6%",
ifelse(Rate>6 & Rate<=8, "6% to 8%",
ifelse(Rate>8 & Rate<=10, "8% to 10%",
ifelse(Rate>10 & Rate<=12, "10% to 12%",
ifelse(Rate>12,"12% or over", "Missing")))))))
);
CountyRate$rate=as.factor(CountyRate$rate);
CountyRate$rate=factor(CountyRate$rate, levels = c("12% or over","10% to 12%","8% to 10%","6% to 8%","4% to 6%","2% to 4%", "2% or lower","Missing")); #order the factor levels
unique(CountyRate$rate)
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Set1", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
library(dplyr);
CountyRate = read.csv("F:/DataCamp/data/CountyUnemployment.csv",header=TRUE, sep=",",stringsAsFactors = FALSE);
dim(CountyRate);
str(CountyRate);
CountyRate$Rate=as.numeric(CountyRate$Rate);
which(complete.cases(CountyRate)==F);  #some counties in some year have missing values
which(complete.cases(CountyRate)==F);
library(stringr);  library(dplyr);
CountyRate=mutate(CountyRate, state=stringr::str_sub(County, -2, -1));  #extract the state name: the last two characters in "County"
head(CountyRate);
library(dplyr);
CountyRate$StateFips=as.character(CountyRate$StateFips);
CountyRate$CountyFips=as.character(CountyRate$CountyFips);
CountyRate=mutate( CountyRate, fips=ifelse(nchar(CountyFips)==3,
paste(StateFips, CountyFips, sep=""),
ifelse(nchar(CountyFips)==2,
paste(StateFips, CountyFips, sep="0"),
paste(StateFips, CountyFips, sep="00")))  );
head(CountyRate);
which(complete.cases(CountyRate)==F);
CountyRate= dplyr::mutate(CountyRate,
rate = ifelse(Rate<=2.0, "2% or lower",
ifelse(Rate>2 & Rate<=4, "2% to 4%",
ifelse(Rate>4 & Rate<=6, "4% to 6%",
ifelse(Rate>6 & Rate<=8, "6% to 8%",
ifelse(Rate>8 & Rate<=10, "8% to 10%",
ifelse(Rate>10 & Rate<=12, "10% to 12%",
ifelse(Rate>12,"12% or over", "Missing")))))))
);
CountyRate$rate=as.factor(CountyRate$rate);
CountyRate$rate=factor(CountyRate$rate, levels = c("12% or over","10% to 12%","8% to 10%","6% to 8%","4% to 6%","2% to 4%", "2% or lower","Missing")); #order the factor levels
unique(CountyRate$rate)
is.na(CountyRate$rate)
is.na(CountyRate$rate)
CountyRate$rate=ifelse(is.na(CountyRate$rate), "Missing", CountyRate$rate);
CountyRate$rate=as.factor(CountyRate$rate);
CountyRate$rate=factor(CountyRate$rate, levels = c("12% or over","10% to 12%","8% to 10%","6% to 8%","4% to 6%","2% to 4%", "2% or lower","Missing")); #order the factor levels
unique(CountyRate$rate);
library(usmap);  library(ggplot2);
PlotCountyRate= function(x)
{
County_year=dplyr::filter(CountyRate, Year==x);
plot_usmap(regions="counties",data = County_year, values ="rate", lines=NA) +
ggplot2::scale_fill_brewer(palette="Set1", name ="Unemployment Rate")+
ggtitle(paste("Distribution of US Unemployment Rate by County in Year",x))+
theme(legend.position = "right");
}
library(magick);
img=image_graph(width=600,height=400,res=96);
for( i in 1:28) print(PlotCountyRate(i+1989));
dev.off();
CountyRateAnimation = image_animate(img, fps = 1);
print(CountyRateAnimation);
#image_write(CountyRateAnimation, "CountyRateAnimation.gif")
library(ggplot2);
help(ggplot);
install.packages(c("ellipsis", "ggplot2", "mime", "mvtnorm"))
install.packages(c("ellipsis", "ggplot2", "mime", "mvtnorm"))
install.packages(c("ellipsis", "ggplot2", "mime", "mvtnorm"))
install.packages(c("ellipsis", "ggplot2", "mime", "mvtnorm"))
